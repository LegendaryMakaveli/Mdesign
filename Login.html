<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login or Create Profile - MDesigns</title>
    <link rel="stylesheet" href="login.css" />

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
      </ul>
    </nav>

    <div class="login-container">
      <h1>Login or Create Profile</h1>

      <div class="form-container">
        <button id="show-login" class="toggle-btn active">Login</button>
        <button id="show-signup" class="toggle-btn">Create Profile</button>

        <form id="login-form" class="form active">
          <input type="email" id="login-email" placeholder="Email" required />
          <input
            type="password"
            id="login-password"
            placeholder="Password"
            required
          />
          <button type="submit">Login</button>
        </form>

        <form id="signup-form" class="form">
          <input
            type="text"
            id="signup-name"
            placeholder="Full Name"
            required
          />
          <input type="email" id="signup-email" placeholder="Email" required />
          <input
            type="password"
            id="signup-password"
            placeholder="Password"
            required
          />
          <button type="submit">Create Profile</button>
        </form>
      </div>
    </div>

    <script src="firebase-config.js"></script>
    <script>
      //switching betwween login and signup

      document.addEventListener("DOMContentLoaded", () => {
        const loginBtn = document.getElementById("show-login");
        const signupBtn = document.getElementById("show-signup");
        const loginForm = document.getElementById("login-form");
        const signupForm = document.getElementById("signup-form");

        loginBtn.addEventListener("click", () => {
          loginForm.classList.add("active");
          signupForm.classList.remove("active");
          loginBtn.classList.add("active");
          signupBtn.classList.remove("active");
        });

        signupBtn.addEventListener("click", () => {
          signupForm.classList.add("active");
          loginForm.classList.remove("active");
          signupBtn.classList.add("active");
          loginBtn.classList.remove("active");
        });
      });

      document
        .getElementById("signup-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const name = document.getElementById("signup-name").value;
          const email = document.getElementById("signup-email").value;
          const password = document.getElementById("signup-password").value;

          const res = await fetch("http://localhost:5000/api/register", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, email, password }),
          });

          const data = await res.json();
          alert(data.message);
        });
      // login and rdirect to dashboard
      document
        .getElementById("login-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = document.getElementById("login-email").value;
          const password = document.getElementById("login-password").value;

          const res = await fetch("http://localhost:5000/api/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await res.json();
          if (data.token) {
            localStorage.setItem("token", data.token);
            alert("Login successful!");
            window.location.href = "dashboard.html"; // Redirect to dashboard
          } else {
            alert(data.message);
          }
        });
      //signup and redirect to dashboard
      document
        .getElementById("signup-form")
        .addEventListener("submit", async (e) => {
          e.preventDefault();

          const name = document.getElementById("signup-name").value;
          const email = document.getElementById("signup-email").value;
          const password = document.getElementById("signup-password").value;

          const res = await fetch("http://localhost:5000/api/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await res.json();
          if (data.token) {
            localStorage.setItem("token", data.token);
            alert("Signup successful!");
            window.location.href = "dashboard.html"; // Redirect to dashboard
          } else {
            alert(data.message);
          }
        });
    </script>
    <script src="script.js"></script>
  </body>
</html>
